{% extends "admin/base_site.html" %}
{% load i18n admin_static app_filters %}
{% block content %}
    {% comment %}    <h1>Clave del Contrato: {{ contratocontratista.clave_contrato }}  <a href="change">Editar</a></h1>
        <ul>
            {% if contratocontratista.no_licitacion != "" %}
                <li>Número de Licitación: {{ contratocontratista.no_licitacion }}</li>
            {% endif %}
            <li>Dependencia: {{ contratocontratista.dependencia }}</li>
            <li>Código de Obra: {{ contratocontratista.codigo_obra }}</li>
            <li>Objeto Contrato: {{ contratocontratista.objeto_contrato }}</li>
            <li>Fecha de Firma: {{ contratocontratista.fecha_firma }}</li>
            <li>Días Pactados: {{ contratocontratista.dias_pactados }}</li>
            <li>Fecha de Inicio: {{ contratocontratista.fecha_inicio }}</li>
            <li>Fecha de Término: {{ contratocontratista.fecha_termino }}</li>
            <li>Lugar de Ejecución: {{ contratocontratista.lugar_ejecucion }}</li>
            <li>Monto del Contrato: {{ contratocontratista.monto_contrato }}</li>
            <li>IVA Aplicable al Contrato: {{ contratocontratista.monto_contrato_iva }}</li>
            <li>Pago Inicial: {{ contratocontratista.pago_inicial }}</li>
            <li>Pago Final: {{ contratocontratista.pago_final }}</li>
            <li>Observaciones: {{ contratocontratista.observaciones }}</li>
        </ul>{% endcomment %}






    <div class="col-xs-10 col-xs-offset-1">
        <div class="card card-info">
            <div class="card-block text-center">
                <div class="row" style="font-size: 12px">
                     <div class="col-xs-12 text-center">
                        <span class="ms-icon ms-icon-circle ms-icon-xxlg mb-4 color-info"><i class="zmdi zmdi-city-alt"></i></span>
                     </div>
                    <div class="col-xs-6 text-left">
                    <h4 class="color-info"><b>Clave del Contrato:</b> {{ contratocontratista.clave_contrato }}</h4>
                    </div>
                    <div class="col-xs-6 text-left">
                    <h4 class="color-info"><b>Contratista:</b> {{ contratocontratista.contratista }}</h4>
                    </div>
                </div>
                <div class="row" style="font-size: 12px">

                    <div class="col-xs-6 text-left">

                        <span class="list-group-item withripple "><i
                                class="fa fa-chevron-right color-active"></i> <span
                                class="color-active">Proyecto:</span> <a href="/admin/ERP/project/dashboard/{{ contratocontratista.project.id }}/">{{ contratocontratista.project.nombreProyecto }}</a></span>

                       {% comment %} <span href="" class="list-group-item withripple "><i
                                class="fa fa-chevron-right color-active"></i> <span
                                class="color-active">Partida:</span> {{ contratocontratista.line_item.description }}</span>
{% endcomment %}
                        <span href="" class="list-group-item withripple "><i
                                class="fa fa-chevron-right color-active"></i> <span
                                class="color-active">Dependencia:</span> {{ contratocontratista.dependencia }}</span>



                        <span href="" class="list-group-item withripple "><i
                                class="fa fa-chevron-right color-active"></i> <span
                                class="color-active">Fecha de Firma:</span> {{ contratocontratista.fecha_firma }}</span>


                        <span href="" class="list-group-item withripple "><i
                                class="fa fa-chevron-right color-active"></i> <span class="color-active">Fecha de Inicio:</span> {{ contratocontratista.fecha_inicio }}</span>

                        <span href="" class="list-group-item withripple "><i
                                class="fa fa-chevron-right color-active"></i> <span class="color-active">Fecha de Término:</span> {{ contratocontratista.fecha_termino }}</span>
                        <span href="" class="list-group-item withripple "><i
                                class="fa fa-chevron-right color-active"></i> <span class="color-active">Monto Contrato:</span> {% for totalpartida in totalpartidas %} ${{ totalpartida.total|intcomma }}{% endfor %}</span>

                        <span href="" class="list-group-item withripple "><i
                                class="fa fa-chevron-right color-active"></i> <span class="color-active">Monto Distribuido:</span> ${{ totaldistribuido|intcomma }}</span>


                       {% comment %} <span href="" class="list-group-item withripple "><i
                                class="fa fa-chevron-right color-active"></i> <span
                                class="color-active">Días Pactados:</span> {{ contratocontratista.dias_pactados }}</span>
{% endcomment %}

                    </div>
                    <div class="col-xs-12 col-sm-6 text-left">

                         {% if contratocontratista.no_licitacion != "" %}
                            <span href="" class="list-group-item withripple "><i
                                    class="fa fa-chevron-right color-active"></i> <span class="color-active">Número de Licitación:</span> {{ contratocontratista.no_licitacion }}</span>
                        {% endif %}
                        <span href="" class="list-group-item withripple "><i
                                class="fa fa-chevron-right color-active"></i> <span class="color-active">Objeto Contrato:</span> {{ contratocontratista.objeto_contrato }}</span>

                        <span href="" class="list-group-item withripple "><i
                                class="fa fa-chevron-right color-active"></i> <span class="color-active">Lugar de Ejecución:</span> {{ contratocontratista.lugar_ejecucion }}</span>
                        {% comment %}<span href="" class="list-group-item withripple "><i
                                class="fa fa-chevron-right color-active"></i> <span class="color-active">Monto del Contrato:</span> {{ contratocontratista.monto_contrato }}</span>
                        {% endcomment %}
                        <span href="" class="list-group-item withripple "><i
                                class="fa fa-chevron-right color-active"></i> <span class="color-active">Porcentaje de IVA del Contrato:</span> {{ contratocontratista.porcentaje_iva }} %</span>

                        {% comment %}<span href="" class="list-group-item withripple "><i
                                class="fa fa-chevron-right color-active"></i> <span class="color-active">Anticipo:</span> {{ advance_payment }}</span>

                        <span href="" class="list-group-item withripple "><i
                                class="fa fa-chevron-right color-active"></i> <span class="color-active">Estatus del anticipo:</span> {{ advance_payment_status }}</span>
{% endcomment %}
                        <span href="" class="list-group-item withripple "><i
                                class="fa fa-chevron-right color-active"></i> <span
                                class="color-active">Observaciones:</span> {{ contratocontratista.observaciones }}</span>
                    </div>
                </div>
                 <a href="change?contrato={{ contratocontratista.id }}" class="btn btn-raised btn-danger button-center-top"><i class="fa fa-pencil"></i> Editar</a>

            </div>
        </div>
    </div>


    <div class="col-xs-10 col-xs-offset-1">
        <div class="card">

            <div class="card-header">
                <div class="item-left">
                    <h3 class="card-title text">Partidas del Contrato</h3>
                </div>
                <div class="item-right">
                    <a onclick="myFunction()" href="/admin/ERP/partidascontratocontratista/add?contrato={{ object.id }}"
                       class="btn-circle btn-circle-sm btn-circle-raised btn-circle-success"><i class="zmdi zmdi-plus zmdi-hc-2x"></i>
                    </a>

                </div>
            </div>

            <div class="card-block text-center">
                <div class="table-responsive">
                                    <table id="table_s" class="table table-bordered">
                                        <thead>
                                        <tr>
                                            <td>Partida</td>
                                            <td>Monto </td>
                                            <td>Días Pactados</td>
                                            <td>Fecha de Inicio</td>
                                            <td>Fecha Propuesta de Termino</td>
                                            <td>Fecha Real de Termino</td>
                                            <td>Conceptos</td>
                                            <td>Editar</td>
                                            <td>Eliminar</td>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% for record in partidas %}
                                            <tr>
                                                <td>{{ record.line_item }}</td>
                                                <td>${{ record.monto_partida|intcomma }}</td>
                                                <td>{{ record.dias_pactados }}</td>
                                                <td>{{ record.fecha_inicio }}</td>
                                                <td>{{ record.fecha_termino_propuesta }}</td>
                                                <td>{{ record.fecha_termino_propuesta }}</td>
                                                <td style="width: 5%">
                                                    <a href="/admin/ERP/contractconcepts/add?contractlineitem={{ record.id }}"
                                                       class="
                                                       btn btn-raised btn-default btn-xs"><i
                                                            class="fa fa-list color-default eliminar"></i>
                                                    </a>
                                                </td>
                                                <td style="width: 5%">
                                                    <a href="/admin/ERP/partidascontratocontratista/{{ record.id }}/change/?contrato={{ request.GET.contrato }}"
                                                       class="
                                                       btn btn-raised btn-default btn-xs"><i
                                                            class="fa fa-pencil color-default eliminar"></i>
                                                    </a>
                                                </td>
                                                <td style="width: 5%">
                                                    <a href="/admin/ERP/partidascontratocontratista/{{ record.id }}/delete/?contrato={{ request.GET.contrato }}"
                                                       class="btn btn-raised btn-default btn-xs"><i
                                                            class="fa fa-trash-o color-danger eliminar"></i>
                                                    </a>
                                                </td>
                                            </tr>
                                        {% endfor %}
                                        </tbody>
                                        <tfoot style="border-bottom: hidden; border-left: hidden; border-right: hidden">
                                        {% for totalpartida in totalpartidas %}
                                            <tr>
                                            <td class="color-active"><span style="font-size: 10px"><b>MONTO CONTRATO</b></span></td>
                                            <td style="border-bottom: hidden; border-left: hidden; border-right: hidden"> ${{ totalpartida.total|intcomma    }} </td>
                                            <td colspan="7"></td>

                                        </tr>
                                             {% endfor %}
                                        </tfoot>
                                    </table>
                                 </div>



            </div>

    </div>
    </div>

    <div class="col-xs-10 col-xs-offset-1">
        <div class="card">

            <div class="card-header">
                <div class="item-left">
                    <h3 class="card-title text">Distribución de Pago</h3>
                </div>
                <div class="item-right">
                    <a onclick="myFunction()" href="/admin/ERP/distribucionpago/add?contrato={{ object.id }}"
                       class="btn-circle btn-circle-sm btn-circle-raised btn-circle-success"><i class="zmdi zmdi-plus zmdi-hc-2x"></i>
                    </a>

                </div>
            </div>

            <div class="card-block text-center">
                                    <table class="table table-bordered">
                                        <thead>
                                        <tr>
                                            <td>Partida</td>
                                            <td align="right">Porcentaje Distribuido</td>
                                            <td align="right">Monto Distribuido</td>

                                        </tr>
                                        </thead>
                                        <tbody>
                                        {% for record in distribuido %}

                                            <tr class="text-small">
                                                <td>{{ record.line_item__key }} - {{ record.line_item__description }}</td>
                                                <td align="right">  {{ record.porcentaje }} %</td>
                                                <td align="right">$ {{ record.asignado|intcomma }}</td>

                                            </tr>
                                        {% endfor %}
                                        </tbody>
                                        <tfoot  style="border-bottom: hidden; border-left: hidden; border-right: hidden">
                                            <tr>

                                                <td colspan="3" align="right" style="border-bottom: hidden; border-left: hidden; border-right: hidden"> <span class="color-active" style="font-size: 10px"> <b>TOTAL DISTRIBUIDO </b>&nbsp;&nbsp;</span>${{ totaldistribuido|intcomma }}</td>
                                            </tr>
                                        </tfoot>
                                    </table>
            </div>
            <div class="card-block text-center">
                <div class="table-responsive">
                    <table id="table_s" class="table table-bordered">
                        {% if distribuciones.count == 0 %}
                            <tbody>
                            <tr>
                                <td align="center">No hay distribución de pago asignada al contrato.</td>
                            </tr>
                            </tbody>
                        {% else %}
                            <thead>
                            <td>Partida</td>
                            <td>Tipo de Pago</td>
                            <td>Porcentaje</td>
                            <td>Monto</td>
                            <td>Fecha de Pago</td>
                            <td class="no-sorting">Editar</td>
                            </thead>
                            <tbody>
                            {% for distribucion in distribuciones %}
                                <tr style="border:1px solid">
                                    <td style="border:1px solid">{{ distribucion.line_item }}</td>
                                    <td style="border:1px solid">{{ distribucion.tipo_pago }}</td>
                                    <td style="border:1px solid">{{ distribucion.porcentaje }}</td>
                                    <td style="border:1px solid">${{ distribucion.monto|intcomma }}</td>
                                    <td style="border:1px solid">{{ distribucion.fecha_pago }}</td>
                                    <td class="text-center" style="width: 5%"><a
                                            href="/admin/ERP/distribucionpago/{{ distribucion.id }}/change?contrato={{ object.id }}"
                                            class="btn btn-raised btn-default btn-xs"><i
                                            class="fa fa-pencil color-default eliminar"></i></a></td>
                                </tr>
                            {% endfor %}
                            </tbody>

                        {% endif %}
                    </table>


            </div>

                </div>
        </div>
    </div>


     <div class="col-xs-10 col-xs-offset-1">
        <div class="card">

            <div class="card-header">
                <div class="item-left">
                    <h3 class="card-title text">Documentación del Contrato</h3>
                </div>
                <div class="item-right">
                    <a onclick="myFunction()" href="/admin/ERP/documentacioncontrato/add?contrato={{ object.id }}"
                       class="btn-circle btn-circle-sm btn-circle-raised btn-circle-success"><i class="zmdi zmdi-plus zmdi-hc-2x"></i>
                    </a>

                </div>
            </div>

            <div class="card-block text-center">
                <div class="table-responsive">
                    <table id="table_s" class="table table-bordered">
                        {% if documentos.count == 0 %}
                            <tbody>
                            <tr>
                                <td align="center">No hay documentos relacionados al contrato.</td>
                            </tr>
                            </tbody>
                        {% else %}
                            <thead>
                            <td>Documento</td>
                            <td>Descripción</td>
                            <td>Descargar</td>
                            <td class="no-sorting">Editar</td>
                            </thead>
                            <tbody>
                            {% for documento in documentos %}
                                <tr style="border:1px solid">
                                    <td style="border:1px solid">{{ documento.nombre_archivo }}</td>
                                    <td style="border:1px solid">{{ documento.descripcion }}</td>
                                    <td style="border:1px solid"><a href="/media/{{ documento.pdf_version }}"><i
                                            class="fa fa-download color-default eliminar"></i></a></td>
                                    <td class="text-center" style="width: 5%"><a
                                            href="/admin/ERP/documentacioncontrato/{{ documento.id }}/change?contrato={{ object.id }}"
                                            class="btn btn-raised btn-default btn-xs"><i
                                            class="fa fa-pencil color-default eliminar"></i></a></td>
                                </tr>
                            {% endfor %}
                            </tbody>
                        {% endif %}
                    </table>
                </div>
            </div>

        </div>
    </div>


{% endblock %}

